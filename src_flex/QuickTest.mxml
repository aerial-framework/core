<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
					   xmlns:s="library://ns.adobe.com/flex/spark" 
					   xmlns:mx="library://ns.adobe.com/flex/mx"
					   xmlns:services="model.services.*" applicationComplete="init()"
					   >
	<fx:Declarations>
		<services:Test2Service id="test2Service" result="result(event)" fault="fault(event)" />
		<services:UserService id="userService" result="resultHandler(event)" fault="faultHandler(event)" />
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import model.services.PostService;
			import model.vo.*;
			
			import mx.collections.ArrayCollection;
			import mx.collections.ListCollectionView;
			import mx.controls.Alert;
			import mx.messaging.messages.RemotingMessage;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			import org.aerial.rpc.operation.Operation;
			
			public var user:UserVO;
			
			
			public function init():void
			{
				WindowStuff();
				
				//testInsert();
				test();
			}

			
			public function test():void
			{
				Number.prototype.undefined = "no defino";
				var n:* = new Number();
				trace(n.undefined);
			}
			
			
			public function testInsert():void
			{
				var topicVo:TopicVO = new TopicVO();
				topicVo.userId = 1;
				topicVo.categoryId = 2;
				topicVo.name = "Robert";
				topicVo.description = "test description";
				
				relations:{
					break relations;
					
					var p1:PostVO = new PostVO();
					p1.message = "HI!";
					p1.title = "Hello";
					
					var p2:PostVO = new PostVO();
					p2.message = "Bye!";
					p2.title = "Cheers";
					
					topicVo.posts = [p1, p2];
					topicVo.User = new UserVO();
					topicVo.User.username = "danny";
				}
				
				
				this.test2Service.insert(new PostVO());
				
				//this.test2Service.insert(topicVo).execute(); 
				//this.test2Service.findAll(topicVo).execute();
			}
			
			
			public function testCallbacks():void
			{
			/* 	this.test2Service.findAll().callback(myCallBack).execute();
				this.test2Service.findAll().execute();
				this.test2Service.findAll().callback(myCallBack).execute(); */
			}
			
			
			public function WindowStuff():void
			{
				nativeWindow.x = Screen.mainScreen.bounds.width - width - 50;
				nativeWindow.y = Screen.mainScreen.bounds.height - height - 150;
				
				nativeWindow.alwaysInFront = false;
				nativeWindow.orderToFront();
			}
			
			
			protected function resultHandler(event:ResultEvent):void
			{
				var message:RemotingMessage = event.token.message as RemotingMessage;
				var operation:String = message.source + "." + message.operation;
				
				switch(operation)
				{
					
					case "UserService.get":
						
						break;
					case "UserService.getAll":
						
						break;
					case "UserService.getRelated":
						if(message.body[0] == "inputLookups"){
							
						}
						break;
					case "UserService.update":
						
						break;
					case "UserService.save":
						
						break;
					
				}
			}
			
			
			protected function faultHandler(event:FaultEvent):void
			{
				Alert.show(event.fault.faultString);
			}
			
			
			public function myCallBack(event:ResultEvent):void
			{
				trace("CALLBACK_1:"  + event.result.toString());	
			}
			
			
			protected function result(event:ResultEvent):void
			{
				trace("RESULT: " + event.result.toString());
			}
			
			
			protected function fault(event:FaultEvent):void
			{
				trace("test fault");
			}
			
			
			
		]]>
	</fx:Script>
	<s:Button x="153" y="98" label="Button" click="testInsert()"/>
	
	
</s:WindowedApplication>
